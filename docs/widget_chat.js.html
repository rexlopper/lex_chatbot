<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: widget/chat.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: widget/chat.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview This file contains the class that will be used to communicate with lex
 *              thur the lex runtime.
 * @author Rex Von Brixon Aparece Apa-ap
 * @version 1.0.0
 * @module AmazonLexV2
 */
const AWS = require('aws-sdk');
const uniqid = require('uniqid');
const {LexRuntimeV2} = require('@aws-sdk/client-lex-runtime-v2');

/** This class instantiatiates a connection with LexV2.*/
module.exports = class AmazonLexV2 {
constructor() {
    this.botName = process.env['APP_BOT_ID'];
    this.alias = process.env['APP_BOT_ALIAS'];
    this.region = process.env['AWS_REGION'];
    this.locale = process.env['APP_LANGUAGE_CODE'];
    this.lexruntime = new LexRuntimeV2({
        region: process.env['AWS_REGION'],
        connectTimeout: 120000 * 10,
        timeout: 120000 * 10,
        credentials: new AWS.Credentials({
            accessKeyId: process.env['AWS_IAM_KEY'], 
            secretAccessKey: process.env['AWS_IAM_SECRET'],
            expired: false
        }),
        logger: 'error'
    })
}
/**
 * 
 * @param {String} textMessage Contains the message text that will be sent to lex.
 * @param {Number} sessionId Session ID of the connection.
 * @returns {Promise}
 */
async sendTextMessageToAWS(textMessage, sessionId) {
    return new Promise((resolve, reject) => {
        this.lexruntime.recognizeText({
            botAliasId: this.alias,
            botId: this.botName,
            text: textMessage,
            localeId: this.locale,
            sessionId: (sessionId) ? sessionId : uniqid()
        }, (err, response) => {
            if (err &amp;&amp; err.message === "The session has been destroyed") {
                resolve(err.message);
            } else if (err) reject(err);        
            else {
                resolve(response);
            }
        })
    })
    }
}



</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AmazonLexV2.html">AmazonLexV2</a></li></ul><h3>Classes</h3><ul><li><a href="module-AmazonLexV2.html">AmazonLexV2</a></li></ul><h3>Global</h3><ul><li><a href="global.html#botReply">botReply</a></li><li><a href="global.html#cardReply">cardReply</a></li><li><a href="global.html#chatLex">chatLex</a></li><li><a href="global.html#events">events</a></li><li><a href="global.html#isValid">isValid</a></li><li><a href="global.html#main">main</a></li><li><a href="global.html#prefixZero">prefixZero</a></li><li><a href="global.html#scrollBottom">scrollBottom</a></li><li><a href="global.html#setReplies">setReplies</a></li><li><a href="global.html#set_selectors">set_selectors</a></li><li><a href="global.html#textReply">textReply</a></li><li><a href="global.html#toggleAnimation">toggleAnimation</a></li><li><a href="global.html#toggleLoading">toggleLoading</a></li><li><a href="global.html#writeMessage">writeMessage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Fri Jul 28 2023 11:33:51 GMT+0800 (Philippine Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
